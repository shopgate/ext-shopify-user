{
	"info": {
		"name": "Shopify Local",
		"_postman_id": "52dcc066-f37a-0ee2-0e45-e7bf5a33de5b",
		"description": "",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "addAddress",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							"pm.environment.set(\"host\", pm.globals.get(\"host\"))",
							"pm.environment.set(\"loginUrl\", \"/trustedPipelines/shopgate.user.loginUser.v1\");",
							"pm.environment.set(\"requestHeader\", { ",
							"            'postman-token': 'cac8b133-6c11-82be-ce3e-f765688ec323',",
							"            'cache-control': 'no-cache',",
							"            'content-type': 'application/json'",
							"})",
							"pm.environment.set(\"login\", pm.globals.get(\"username\"))",
							"pm.environment.set(\"password\", pm.globals.get(\"password\"))",
							"",
							"pm.sendRequest(",
							"    {",
							"        url: pm.variables.get(\"host\") + pm.variables.get(\"loginUrl\"),",
							"        method: 'POST',",
							"        header: pm.variables.get(\"requestHeader\"),",
							"        body: ",
							"        {",
							"            mode: 'raw',",
							"            raw: JSON.stringify({",
							"                strategy: 'basic',",
							"                parameters: { login: pm.variables.get(\"login\"), password: pm.variables.get(\"password\") }",
							"            })",
							"        },",
							"        json: true",
							"    }",
							");",
							"",
							"// Create a randomized address to avoid duplicate addresses for the first request. But we need this also to create duplicate address on the second attempt",
							"pm.environment.set(\"randomizedStreet\", Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15));"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n\t\"address\": {\n\t\t\"firstName\": \"Test\",\n        \"lastName\": \"Moped\",\n        \"company\": \"Moped AG\",\n        \"street1\": \"{{randomizedStreet}}\",\n        \"street2\": \"Moped\",\n        \"city\": \"Mopedhausen\",\n        \"state\": \"Mopedville\",\n        \"phone\": \"555-Nase\",\n        \"isDefault\": false,\n        \"alias\": null,\n        \"zipcode\": \"12345\",\n        \"country\": \"GB\"\n\t}\n}"
				},
				"url": {
					"raw": "{{addAddressUrl}}",
					"host": [
						"{{addAddressUrl}}"
					]
				},
				"description": ""
			},
			"response": []
		}
	]
}